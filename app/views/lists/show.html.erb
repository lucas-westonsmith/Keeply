<div class="list-show-container">
  <% if @list.photo.attached? %>
    <div class="list-image">
      <%= image_tag @list.photo, alt: "List photo" %>
    </div>
  <% else %>
    <div class="list-image">
      <%= image_tag "default-list.avif", alt: "Default list photo" %>
    </div>
  <% end %>

  <div class="list-details container">
    <h1 class="list-title"><%= @list.title %></h1>
    <p class="list-description"><%= @list.description %></p>

    <div class="list-shared">
      <h3>Shared with:</h3>
      <ul>
        <% @list.list_users.each do |list_user| %>
          <li>
            <%= list_user.user.email %>
            <% if list_user.user != current_user %>
              <%= link_to 'Remove', list_user_path(list_user), method: :delete, data: { turbo_method: :delete, confirm: 'Are you sure?' }, class: 'btn btn-sm btn-danger' %>
            <% end %>
          </li>
        <% end %>
      </ul>
    </div>

    <div class="add-user-form mt-4">
      <h3>Invite a user to this list</h3>
      <%= form_with url: list_list_users_path(@list), local: true, method: :post do %>
        <div class="form-group">
          <%= text_field_tag :email, nil, class: "form-control", placeholder: "Enter user's email" %>
        </div>
        <%= submit_tag "Invite", class: "btn btn-primary mt-2" %>
      <% end %>
    </div>

    <div class="list-actions">
      <%= link_to 'Back to lists', lists_path, class: 'btn btn-secondary' %>
      <%= link_to 'Edit', edit_list_path(@list), class: 'btn btn-primary' %>
      <%= link_to 'Delete', @list, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger' %>
    </div>
  </div>

  <div class="list-items container my-5">
    <h2 class="list-items-title">Items in this list</h2>
    <%= link_to 'Add a new item', new_list_item_path(@list), class: 'btn btn-primary add-item-button' %>

    <% if @list.items.any? %>
      <div class="items-list">
        <% @list.items.each do |item| %>
          <div class="item-card">
            <%= link_to item_path(item), class: "item-link" do %>
              <div class="item-image">
                <% if item.photo.attached? %>
                  <%= image_tag item.photo, alt: "Item photo" %>
                <% else %>
                  <%= image_tag "default-item.avif", alt: "Default item photo" %>
                <% end %>
              </div>
              <div class="item-title">
                <h3><%= item.title %></h3>
              </div>
              <div class="item-details">
                <p class="item-price"><strong>Price:</strong> <%= item.price %>â‚¬</p>
                <p class="item-category"><strong>Category:</strong> <%= item.category %></p>
                <p class="item-condition"><strong>Condition:</strong> <%= item.condition.capitalize %></p>
              </div>
            <% end %>
            <div class="item-actions">
              <%= link_to remove_item_from_list_path(@list, item.id), method: :delete, data: { turbo_method: :delete, confirm: 'Are you sure?' }, class: 'btn btn-warning remove-item-button' do %>
                Remove from list
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="no-items-message">
        <h3>ðŸ“­ No items added to this list yet!</h3>
        <p>Start by clicking the <strong>Add a new item</strong> button above and fill your list with awesome items! âœ¨</p>
      </div>
    <% end %>
  </div>
</div>
